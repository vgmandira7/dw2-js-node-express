<%- include ('partials/header.ejs') %>
<%- include ('partials/navbar.ejs', { activeLink: 'filmes' }) %>

<div class="main-content">

  <!-- CARD de CADASTRO -->
  <div class="card add-movie-card">
    <div class="card-header-movies">
      <h2>Cadastrar Novo Filme</h2>
    </div>

    <div class="card-body">
      <form action="/filmes/new" method="POST" class="movie-form">

        <div class="form-group">
          <label>Título:</label>
          <input type="text" name="titulo" required />
        </div>

        <div class="form-group">
          <label>Diretor:</label>
          <input type="text" name="diretor" required />
        </div>

        <div class="form-group">
          <label>Ano:</label>
          <input type="number" name="ano" required />
        </div>

        <div class="form-group">
          <label>Gênero:</label>
          <input type="text" name="genero" required />
        </div>

        <div class="form-group">
          <label>Duração (min):</label>
          <input type="number" name="duracao" required />
        </div>

        <div class="form-group">
          <label>Avaliação (0–10):</label>
          <input type="number" step="0.1" name="avaliacao" min="0" max="10" required />
        </div>

        <button type="submit" class="btn-add-movie">Cadastrar</button>
      </form>
    </div>
  </div>

  <!-- CARD Lista de Filmes -->
  <div class="card all-movies-card">
    <div class="card-header-movies">
      <h2>Todos os Filmes (<%= filmes.length %>)</h2>
    </div>

    <div class="card-body">

      <div class="movie-list-header">
        <div class="header-item header-titulo">Título</div>
        <div class="header-item header-diretor">Diretor</div>
        <div class="header-item header-ano">Ano</div>
        <div class="header-item header-genero">Gênero</div>
        <div class="header-item header-duracao">Duração</div>
        <div class="header-item header-avaliacao">Avaliação</div>
        <div class="header-item header-acoes">Ações</div>
      </div>

      <ul class="movie-items-list">
        <% filmes.forEach((filme, index) => { %>
          <li class="movie-item-row">

            <div class="movie-cell movie-title">
              <span class="movie-index"><%= index + 1 %></span>
              <span><%= filme.titulo %></span>
            </div>

            <div class="movie-cell movie-director">
              <span><%= filme.diretor %></span>
            </div>

            <div class="movie-cell movie-year">
              <span><%= filme.ano %></span>
            </div>

            <div class="movie-cell movie-genre">
              <span class="genre-tag <%= filme.genero.toLowerCase().replace(' ', '-') %>">
                <%= filme.genero %>
              </span>
            </div>

            <div class="movie-cell movie-duration">
              <span><%= filme.duracao %> min</span>
            </div>

            <div class="movie-cell movie-rating">
              <i class="fas fa-star"></i>
              <span><%= filme.avaliacao %></span>
            </div>

            <!-- Botão de excluir -->
<div class="movie-cell movie-actions">
    <a href="/filmes/edit/<%= filme.id %>">
        <button class="edit-btn">Editar</button>
    </a>

    <a href="/filmes/delete/<%= filme.id %>"
       onclick="return confirm('Deseja excluir o filme <%= filme.titulo %>?')">
        <button class="delete-btn">Excluir</button>
    </a>
</div>

          </li>
        <% }) %>
      </ul>

    </div>
  </div>

</div>

<%- include ('partials/footer.ejs') %>
